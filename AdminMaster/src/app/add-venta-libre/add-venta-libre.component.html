<!-- Estados de la venta -->
<div class="container paga-credit">
  <div class="estado-buttons">
    <button type="button" class="btn-confirmado" [class.active]="isEstado('confirmada')" (click)="setEstado('confirmada')">Confirmada</button>
    <button type="button" class="btn-pendiente" [class.active]="isEstado('pendiente')" (click)="setEstado('pendiente')">Pendiente</button>
  </div>
</div>
<br>

<!-- Formulario Registro Venta Libre -->
<div class="container-fluid form">
  <div class="formulario">
    <form (ngSubmit)="onSubmit()" #ventaForm="ngForm">
      <div class="form-grid">
        <!-- nombre de la venta -->
        <div class="mb-3">
          <label class="form-label">Nombre de la Venta</label>
          <input #nombreVentaInput data-autofocus="true" type="text" class="form-control" name="nombreVenta" [(ngModel)]="nombreVenta" placeholder="Venta mostrador, Venta rápida..." />
        </div>

        <!-- productos -->
        <div class="mb-3 span-2">
          <label class="form-label d-block">Productos</label>
          <div class="productos">
            <!-- Product Inputs with labels above each -->
            <div class="producto" *ngFor="let p of productos; let i = index">
              <div class="input-group">
                <label class="form-label small mb-1">Nombre</label>
                <input class="form-control" [(ngModel)]="p.nombre" name="prodNombre{{i}}" />
              </div>
              
              <div class="input-group">
                <label class="form-label small mb-1">Cantidad</label>
                <input type="number" class="form-control text-center" min="1" [(ngModel)]="p.cantidad" name="prodCant{{i}}" (input)="updateSubtotal(i)" />
              </div>
              
              <div class="input-group">
                <label class="form-label small mb-1">Valor</label>
                <input type="number" class="form-control text-end" min="0" step="1" inputmode="numeric" [(ngModel)]="p.precio" name="prodPrecio{{i}}" (input)="updateSubtotal(i)" />
              </div>
              
              <div class="input-group">
                <label class="form-label small mb-1">Total</label>
                <input class="form-control text-end" [value]="p.subtotal | number:'1.0-0'" readonly />
              </div>
              
              <div class="d-flex align-items-end">
                <button type="button" class="btn btn-danger" (click)="removeProducto(i)" *ngIf="productos.length > 1">Eliminar</button>
              </div>
            </div>
            <div class="mt-2">
              <button type="button" class="btn btn-secondary" (click)="addProducto()">Agregar producto</button>
            </div>
          </div>
        </div>

        <!-- total -->
        <div class="mb-3">
          <label class="form-label">Total</label>
          <input class="form-control" [value]="total | number:'1.0-0'" readonly />
        </div>

        <!-- observaciones -->
        <div class="mb-3 span-2">
          <label class="form-label">Observaciones</label>
          <textarea class="form-control" rows="2" name="observaciones" [(ngModel)]="observaciones" placeholder="cliente pidió sin factura, venta rápida, ..."></textarea>
        </div>

        <!-- forma_pago -->
        <div class="mb-3 span-2">
          <label class="form-label d-block">Forma de Pago</label>
          <div class="pago-options">
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="efectivo" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/efectivo.png" alt="Efectivo" />
              <span>Efectivo</span>
            </label>
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="tarjeta" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/targeta.png" alt="Tarjeta" />
              <span>Tarjeta</span>
            </label>
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="transferencia" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/banco.png" alt="Transferencia" />
              <span>Transferencia</span>
            </label>
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="daviplata" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/daviplata.ico" alt="Daviplata" />
              <span>Daviplata</span>
            </label>
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="nequi" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/nequi.ico" alt="Nequi" />
              <span>Nequi</span>
            </label>
            <label class="pago-option">
              <input type="radio" name="formaPago" [(ngModel)]="formaPago" value="otros" />
              <img class="img-pago" src="assets/img/icons-metodo de pago/otro.png" alt="Otros" />
              <span>Otros</span>
            </label>
          </div>
        </div>

        <div class="mb-3 span-2" *ngIf="formaPago && formaPago !== 'efectivo'">
          <label class="form-label">ID de Transacción</label>
          <input type="text" class="form-control" name="transaccionId" [(ngModel)]="transaccionId" placeholder="ID / referencia de la transacción" />
        </div>
        
        <!-- confirmar -->
        <div class="confirmarfinal">
          <button type="submit" class="btn create-venta" [disabled]="submitting">Confirmar Venta</button>
        </div>
      </div>
    </form>
  </div>
</div>