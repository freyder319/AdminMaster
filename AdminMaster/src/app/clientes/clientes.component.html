<header>
  <app-admin-navbar></app-admin-navbar>
</header>

<main>
  <!-- Vista normal (solo cuando NO estoy en agregar NI modificar) -->
  <div *ngIf="!mostrarAddCliente && !mostrarModificarCliente">

    <!-- Titulo -->
    <section>
      <div class="container text-center">
        <div class="row">
          <div class="col">
            <h1 class="tit-clientes">Clientes</h1>
          </div>
        </div>
      </div>
    </section>

    <br>

    <!-- Busqueda y Agregar -->
    <section>
      <div class="container buscar-agg">
        <div class="row">
          <!-- Buscar -->
          <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="search">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Buscar Cliente..." id="search-input">
              </div>
            </div>
          </div>

          <!-- Agregar Cliente -->
          <div class="col-sm-12 col-md-6 col-lg-6">
            <div class="agg-cli">

              <!-- Para pantallas grandes (≥768px) → abre offcanvas -->
              <button class="btn agregar d-none d-md-inline-block" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasAddCliente" aria-controls="offcanvasAddCliente">
                <span class="texto">Agregar Cliente</span>
                <img width="80px" src="../../assets/img/icons_clientes/agregarCliente.png" alt="">
              </button>

              <!-- Para pantallas pequeñas (<768px) → cambia de interfaz -->
              <button class="btn agregar d-md-none" type="button" (click)="mostrarAddCliente = true">
                <span class="texto">Agregar Cliente</span>
                <img width="80px" src="../../assets/img/icons_clientes/agregarCliente.png" alt="">
              </button>

            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tablas Informacion -->
    <section>
      <div class="container">
        <table class="table table-bordered">
          <thead class="table-secondary">
            <tr>
              <th>Nombre</th>
              <th>Correo</th>
              <th>Teléfono</th>
              <th>N° Deudas</th>
              <th>N° Compras</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let cliente of clientes">
              <td data-label="Nombre">
                <!-- Solo visible en móviles (<768px), clickeable -->
                <div class="perfil clickable d-md-none" (click)="mostrarInterfazReponsive(cliente.id)">
                  <img src="../../assets/img/icons-navbar/Clientes.png" alt="cliente">
                  <div class="info">
                    <p class="nombre">{{cliente.nombre}}</p>
                    <p class="correo">{{cliente.correo}}</p>
                  </div>
                </div>

                <!-- Solo visible en escritorio (≥768px), NO clickeable -->
                <div class="perfil d-none d-md-flex">
                  <img src="../../assets/img/icons-navbar/Clientes.png" alt="Camión Coca-Cola" width="50px" height="50px" style="margin-top: -10px;">
                  <div class="info">
                    <p class="nombre" style="margin-left: 10px;">{{cliente.nombre}}</p>
                  </div>
                </div>
                </td>

              <td data-label="Correo">{{cliente.correo}}</td>
              <td data-label="Teléfono">{{cliente.numero}}</td>
              <td data-label="N° Deudas">0</td>
              <td data-label="N° Compras">0</td>
              <td data-label="Estado de Cliente">
                <span class="status activo">{{cliente.estado}}</span>
              </td>
              <td data-label="Acciones" class="acciones">

                <!-- Botones con texto (solo ≥1200px) -->
                <div class="d-none d-xl-flex gap-2">

                  <!-- OffCanvas Modificar Cliente -->
                  <button class="btn modificar d-none d-md-inline-block" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModifyCliente" aria-controls="offcanvasModifyCliente">
                    <span class="texto">Modificar</span>
                  </button>

                  <button (click)="eliminarCliente(cliente.id)" class="btn elimi">Eliminar</button>
                </div>

                <!-- Botones con íconos (768px – 1200px) -->
                <div class="d-none d-md-flex d-xl-none gap-2">
                  <button class="btn modificar icon-btn d-none d-md-inline-block" title="Modificar" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasModifyCliente" aria-controls="offcanvasModifyCliente">
                    <i class="bi bi-pencil-square"></i>
                  </button>
                  <button (click)="eliminarCliente(cliente.id)" class="btn eliminar-icon icon-btn" title="Eliminar">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="clientes.length === 0">
              <td colspan="7" class="text-center">No hay clientes registrados</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>
  <!-- Vista de Agregar Cliente en móvil (<768px) -->
  <div *ngIf="mostrarAddCliente" class="d-md-none">
    <div class="container mt-4 p-3 shadow rounded bg-light">
      <app-add-clientes></app-add-clientes>
      <div class="mt-3">
        <button class="btn btn-volver" type="button" (click)="mostrarAddCliente = false">
          <i class="bi bi-arrow-left-short"></i> Volver
        </button>
      </div>
    </div>
  </div>

  <!-- Vista de Modificar Cliente en móvil (<768px) -->
  <div *ngIf="mostrarModificarCliente" class="d-md-none">
    <div class="container mt-4 p-3 shadow rounded bg-light">
      <app-modify-cliente></app-modify-cliente>
      <div class="mt-3 space">
        <button class="btn btn-volver" type="button" (click)="mostrarModificarCliente = false">
          <i class="bi bi-arrow-left-short"></i> Volver
        </button>
        <button *ngIf="clienteSeleccionado" (click)="eliminarCliente(clienteSeleccionado.id)" class="btn eliminar">
            <i class="bi bi-trash-fill"></i>Eliminar
        </button>
    </div>
    </div>
  </div>

</main>

<!-- Offcanvas (solo para pantallas grandes) Agregar -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasAddCliente" aria-labelledby="offcanvasAddClienteLabel">
  <div class="offcanvas-header">
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
  </div>
  <div class="offcanvas-body">
    <app-add-clientes></app-add-clientes>
  </div>
</div>

<!-- Offcanvas (solo para pantallas grandes) Modificar -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasModifyCliente" aria-labelledby="offcanvasModifyClienteLabel">
  <div class="offcanvas-header">
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
  </div>
  <div class="offcanvas-body">
    <app-modify-cliente></app-modify-cliente>
  </div>
</div>